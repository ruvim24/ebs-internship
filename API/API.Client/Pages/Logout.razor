@page "/logout"
@using API.Client.Components
@using API.Client.Services
@inject ISnackbar Snackbar
@inject AccountService AccountService
@inject NavigationManager Navigation
@inject IDialogService DialogService


<MudButton OnClick="HandleLogout" Variant="Variant.Filled" Color="Color.Secondary">Logout</MudButton>

@code {
    
    private async Task HandleLogout()
    {
        var dialog = DialogService.Show<ConfirmationDialog>("Are you sure?");
        var result = await dialog.Result;
        
        if (!result!.Canceled)
        {
            var response = await AccountService.Logout();
            if (response.IsSuccessStatusCode)
            {
                Snackbar.Add("Logged out successfully", Severity.Success);
                Navigation.NavigateTo("/login", forceLoad: true);
            }
            else
            {
                Snackbar.Add("You are already logged out", Severity.Error);
            }
        }
    }
}